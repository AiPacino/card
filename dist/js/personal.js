"use strict";!function(){document.querySelectorAll(".cancel-collection").forEach(function(e){e.addEventListener("click",function(t){var r=e.parentNode.querySelector("a");cardId=r.href.match(/edituser\/(\S*)/)[1];var a=new XMLHttpRequest;a.onreadystatechange=function(){(a.readyState=200==a.status)&&"1"==a.responseText&&(e.parentNode.parentNode.removeChild(e.parentNode),new Notyf({delay:2e3}).confirm("取消收藏成功"))},a.open("POST","/deletecollection",!0),a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),a.send("cardId="+cardId)})})}(),function(){var e=document.querySelector(".acount-info"),t=document.querySelector(".personal-useremail"),r=document.querySelector(".personal-usercode"),a=document.querySelector(".personal-reusercode"),n=t.querySelector("input"),o=r.querySelector("input"),s=a.querySelector("input"),c=n.value;e.addEventListener("click",function(e){var a=new Notyf({delay:2e3}),i=e.target;if("修改"==i.innerText){var l=i.parentNode;switch(l){case t:n.removeAttribute("disabled"),i.innerText="提交";break;case r:o.removeAttribute("disabled"),s.removeAttribute("disabled"),i.innerText="提交"}}else if("提交"==i.innerText){var l=i.parentNode;switch(l){case t:var d=/^[a-zA-Z0-9_-]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/;if(n.value==c)a.alert("您输入的邮箱与原邮箱一致");else if(d.test(n.value)){var u=new XMLHttpRequest;u.onreadystatechange=function(){4==u.readyState&&200==u.status&&("1"==u.responseText?a.confirm("邮箱修改成功"):a.confirm("邮箱修改失败,请重试"))},u.open("POST","/checkemail",!0),u.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),u.send("email="+n.value)}else n.value=c,a.alert("邮箱格式有误");n.setAttribute("disabled",""),i.innerText="修改";break;case r:if(o.value&&s)if(n.value&&s.value.length<8)a.alert("新密码长度不能小于8个字符");else{var u=new XMLHttpRequest;u.onreadystatechange=function(){4==u.readyState&&200==u.status&&("1"==u.responseText?a.confirm("密码修改成功"):"0"==u.responseText?a.alert("原密码错误，请重新输入"):a.alert("密码修改失败，请重试"))},u.open("POST","/checkpassword",!0),u.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),u.send("originpassword="+o.value+"&newpassword="+s.value)}else a.alert("密码不能为空");o.setAttribute("disabled",""),s.setAttribute("disabled",""),i.innerText="修改"}}})}();